// Porosity Quiz Logic
(function() {
    // Wait for StudioForm to be available
    window.StudioForm = window.StudioForm || [];
    window.StudioForm.push(() => {
      // Initialize when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initPorosityQuiz);
      } else {
        initPorosityQuiz();
      }
    });
  
    function initPorosityQuiz() {
      // Get the quiz form instance
      const quizForm = document.querySelector('[sf-id="suku_quiz"]');
      if (!quizForm) return;
  
      // Function to determine porosity based on answers
      function calculatePorosity(q3a, q3b) {
        // Define combinations that should show "high" porosity
        const highPorosityCombinations = [
          ['A', 'B'], // 3A(a) and 3B(b)
          ['A', 'A'], // 3A(a) and 3B(a)
          ['A', 'C'], // 3A(a) and 3B(c)
          ['B', 'A'], // 3A(b) and 3B(a)
          ['B', 'B']  // 3A(b) and 3B(b)
        ];
  
        // Check if current combination matches any high porosity combination
        const isHighPorosity = highPorosityCombinations.some(combination => 
          combination[0] === q3a && combination[1] === q3b
        );
  
        return isHighPorosity ? 'high' : 'low';
      }
  
      // Listen for radio button changes on questions 3A and 3B
      function handleQuizAnswers() {
        const q3aAnswer = quizForm.querySelector('input[name="Question-3A"]:checked')?.value;
        const q3bAnswer = quizForm.querySelector('input[name="Question-3B"]:checked')?.value;
  
        if (q3aAnswer && q3bAnswer) {
          const porosity = calculatePorosity(q3aAnswer, q3bAnswer);
          
          // Hide both results first
          document.querySelector('[sf-name="low"]')?.style.setProperty('display', 'none');
          document.querySelector('[sf-name="high"]')?.style.setProperty('display', 'none');
          
          // Show the appropriate result
          document.querySelector(`[sf-name="${porosity}"]`)?.style.setProperty('display', 'block');
  
          // Hide the button group
          const buttonGroup = document.querySelector('.sf-form_button-group');
          if (buttonGroup) {
            buttonGroup.style.setProperty('display', 'none');
          }
  
          // Log the combination and result (for testing purposes)
          console.log(`Combination: 3A(${q3aAnswer}) and 3B(${q3bAnswer}) = ${porosity} porosity`);
        }
      }
  
      // Add listeners to the form
      quizForm.addEventListener('change', handleQuizAnswers);
    }
  })();